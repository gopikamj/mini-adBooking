{"ast":null,"code":"var _jsxFileName = \"D:\\\\gopika\\\\online-newspaper-ad-booking\\\\frontend\\\\src\\\\pages\\\\AdBooking.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"../styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AdBooking = () => {\n  _s();\n  var _location$state;\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [adSpaces, setAdSpaces] = useState([]);\n  const [selectedAdSpace, setSelectedAdSpace] = useState(null);\n  const [adContent, setAdContent] = useState(\"\");\n  const [calculatedPrice, setCalculatedPrice] = useState(0);\n  const newspaper = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.newspaper; // Get selected newspaper from navigation\n\n  useEffect(() => {\n    if (!newspaper) return;\n\n    // Fetch ad spaces for the selected newspaper\n    axios.get(`/api/adspaces/${newspaper.id}`).then(res => setAdSpaces(res.data));\n  }, [newspaper]);\n  const handleAdSpaceSelect = space => {\n    if (space.isBooked) return;\n    setSelectedAdSpace(space);\n  };\n  const handleAdContentChange = e => {\n    const content = e.target.value;\n    setAdContent(content);\n\n    // ✅ Ensure content fits in available space\n    const maxCharacters = selectedAdSpace ? selectedAdSpace.maxCharacters : 100;\n    if (content.length > maxCharacters) {\n      alert(`Content is too long! Max allowed: ${maxCharacters} characters.`);\n      return;\n    }\n\n    // ✅ Calculate price dynamically\n    setCalculatedPrice(content.length * newspaper.price_per_word);\n  };\n  const handleBookAd = async () => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n    const bookingData = {\n      newspaperId: newspaper.id,\n      adSpaceId: selectedAdSpace.id,\n      content: adContent,\n      price: calculatedPrice\n    };\n    try {\n      await axios.post(\"/api/bookad\", bookingData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(\"Ad booked successfully! Confirmation email sent.\");\n      navigate(\"/user-dashboard\");\n    } catch (error) {\n      console.error(\"Booking failed\", error);\n      alert(\"Failed to book ad. Try again.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ad-booking\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Book an Ad in \", newspaper === null || newspaper === void 0 ? void 0 : newspaper.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"newspaper-layout\",\n      children: adSpaces.length > 0 ? adSpaces.map(space => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `ad-space ${space.isBooked ? \"booked\" : \"available\"}`,\n        onClick: () => handleAdSpaceSelect(space),\n        children: space.isBooked ? \"Booked\" : `Price: ₹${space.price}`\n      }, space.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading ad spaces...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), selectedAdSpace && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ad-input\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Enter Ad Content\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: adContent,\n        onChange: handleAdContentChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Price: \\u20B9\", calculatedPrice]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleBookAd,\n        children: \"Book Ad\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n_s(AdBooking, \"ZBUjKE7CfbDA2jXKguMiA4hAEkU=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = AdBooking;\nexport default AdBooking;\nvar _c;\n$RefreshReg$(_c, \"AdBooking\");","map":{"version":3,"names":["React","useState","useEffect","useLocation","useNavigate","axios","jsxDEV","_jsxDEV","AdBooking","_s","_location$state","location","navigate","adSpaces","setAdSpaces","selectedAdSpace","setSelectedAdSpace","adContent","setAdContent","calculatedPrice","setCalculatedPrice","newspaper","state","get","id","then","res","data","handleAdSpaceSelect","space","isBooked","handleAdContentChange","e","content","target","value","maxCharacters","length","alert","price_per_word","handleBookAd","token","localStorage","getItem","bookingData","newspaperId","adSpaceId","price","post","headers","Authorization","error","console","className","children","name","fileName","_jsxFileName","lineNumber","columnNumber","map","onClick","onChange","_c","$RefreshReg$"],"sources":["D:/gopika/online-newspaper-ad-booking/frontend/src/pages/AdBooking.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport \"../styles.css\";\r\n\r\nconst AdBooking = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [adSpaces, setAdSpaces] = useState([]);\r\n  const [selectedAdSpace, setSelectedAdSpace] = useState(null);\r\n  const [adContent, setAdContent] = useState(\"\");\r\n  const [calculatedPrice, setCalculatedPrice] = useState(0);\r\n  const newspaper = location.state?.newspaper; // Get selected newspaper from navigation\r\n\r\n  useEffect(() => {\r\n    if (!newspaper) return;\r\n    \r\n    // Fetch ad spaces for the selected newspaper\r\n    axios.get(`/api/adspaces/${newspaper.id}`).then((res) => setAdSpaces(res.data));\r\n  }, [newspaper]);\r\n\r\n  const handleAdSpaceSelect = (space) => {\r\n    if (space.isBooked) return;\r\n    setSelectedAdSpace(space);\r\n  };\r\n\r\n  const handleAdContentChange = (e) => {\r\n    const content = e.target.value;\r\n    setAdContent(content);\r\n    \r\n    // ✅ Ensure content fits in available space\r\n    const maxCharacters = selectedAdSpace ? selectedAdSpace.maxCharacters : 100;\r\n    if (content.length > maxCharacters) {\r\n      alert(`Content is too long! Max allowed: ${maxCharacters} characters.`);\r\n      return;\r\n    }\r\n\r\n    // ✅ Calculate price dynamically\r\n    setCalculatedPrice(content.length * newspaper.price_per_word);\r\n  };\r\n\r\n  const handleBookAd = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const bookingData = {\r\n      newspaperId: newspaper.id,\r\n      adSpaceId: selectedAdSpace.id,\r\n      content: adContent,\r\n      price: calculatedPrice,\r\n    };\r\n\r\n    try {\r\n      await axios.post(\"/api/bookad\", bookingData, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      alert(\"Ad booked successfully! Confirmation email sent.\");\r\n      navigate(\"/user-dashboard\");\r\n    } catch (error) {\r\n      console.error(\"Booking failed\", error);\r\n      alert(\"Failed to book ad. Try again.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"ad-booking\">\r\n      <h2>Book an Ad in {newspaper?.name}</h2>\r\n      \r\n      {/* ✅ Virtual Newspaper Layout */}\r\n      <div className=\"newspaper-layout\">\r\n        {adSpaces.length > 0 ? (\r\n          adSpaces.map((space) => (\r\n            <div\r\n              key={space.id}\r\n              className={`ad-space ${space.isBooked ? \"booked\" : \"available\"}`}\r\n              onClick={() => handleAdSpaceSelect(space)}\r\n            >\r\n              {space.isBooked ? \"Booked\" : `Price: ₹${space.price}`}\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <p>Loading ad spaces...</p>\r\n        )}\r\n      </div>\r\n\r\n      {selectedAdSpace && (\r\n        <div className=\"ad-input\">\r\n          <h3>Enter Ad Content</h3>\r\n          <textarea value={adContent} onChange={handleAdContentChange} />\r\n          <p>Price: ₹{calculatedPrice}</p>\r\n          <button onClick={handleBookAd}>Book Ad</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdBooking;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}